<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-overview/architecture">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">System Architecture | SoftPack</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wtsi-hgi.github.io/softpack-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wtsi-hgi.github.io/softpack-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://wtsi-hgi.github.io/softpack-docs/docs/overview/architecture"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="System Architecture | SoftPack"><meta data-rh="true" name="description" content="This documentation is under development and may be incomplete."><meta data-rh="true" property="og:description" content="This documentation is under development and may be incomplete."><link data-rh="true" rel="icon" href="/softpack-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wtsi-hgi.github.io/softpack-docs/docs/overview/architecture"><link data-rh="true" rel="alternate" href="https://wtsi-hgi.github.io/softpack-docs/docs/overview/architecture" hreflang="en"><link data-rh="true" rel="alternate" href="https://wtsi-hgi.github.io/softpack-docs/docs/overview/architecture" hreflang="x-default"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"><link rel="stylesheet" href="/softpack-docs/assets/css/styles.415f0983.css">
<link rel="preload" href="/softpack-docs/assets/js/runtime~main.9ae93b6b.js" as="script">
<link rel="preload" href="/softpack-docs/assets/js/main.19df5f50.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/softpack-docs/"><div class="navbar__logo"><img src="/softpack-docs/img/softpack.png" alt="SoftPack Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/softpack-docs/img/softpack.png" alt="SoftPack Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SoftPack</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/softpack-docs/docs/category/overview">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wtsi-hgi/softpack-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/softpack-docs/docs/category/overview">Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/softpack-docs/docs/overview/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/softpack-docs/docs/overview/features">Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/softpack-docs/docs/overview/architecture">System Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/softpack-docs/docs/overview/testing_strategy">Testing Strategy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/softpack-docs/docs/overview/deployment">Deployment</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/softpack-docs/docs/category/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/softpack-docs/docs/category/how-to-guides">How-to Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;How-to Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/softpack-docs/docs/category/reference">Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/softpack-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/softpack-docs/docs/category/overview"><span itemprop="name">Overview</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">System Architecture</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>System Architecture</h1><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>This documentation is under development and may be incomplete.</p></div></div><p>SoftPack is built using a modern <a href="https://letmegooglethat.com/?q=what+is+microservices+architecture" target="_blank" rel="noopener noreferrer">microservices architecture</a>. Unlike monolithic
monstrosities of the past, modern software systems are almost always built
with smaller lightweight services that interoperate together and communicate
to each other using well-defined interfaces over standard protocols.</p><p>The architecture described here is composed of loosely-connected stateless
services capable of being deployed, upgraded, restarted and scaled up,
independent of other services in the system. Some services are more resource
intensive than others and benefit from running in an environment where
additional nodes can be added for load-balancing concurrent tasks. Other
services, however, can happily operate a single-threaded FIFO queue without
becoming a bottleneck in the system. In a microservice architecture, each
service is capable of being scaled horizontally only when necessary and
capacity planning decisions do not need to be made up front. </p><p><strong>Notation</strong></p><p>A quick word about the notation used in the diagrams in the documentation
before we proceed. </p><ol><li><p>Only uni-directional arrows are used in the diagrams below. This is by
design. The notation <code>X → Y</code> should be read as, <code>X</code> uses <code>Y</code> or <code>X</code> calls <code>Y</code>,
or <code>X</code> sends a message to <code>Y</code>.  Most inter-service communication requires
bidirectional messaging. However, in a request-response framework, the request
are response are rarely symmetric, so bidirectional arrows are generally
misleading. Another arrow in the opposite direction denoting the response would
make more sense but that practice is avoided here to reduce unnecessary clutter.</p></li><li><p>The <code>/</code> symbol is used to denote layering of protocol or messaging in the
stack and not an either/or substitution marker. For example, <code>HTML / HTTP</code>
or <code>REST / HTTP</code> are read as <code>HTML</code> over <code>HTTP</code>, and <code>REST</code> over <code>HTTP</code>
respectively.</p></li><li><p>Error conditions are excluded from the diagrams for brevity. The diagrams
do not mean that every service will always return <code>ststus = OK</code>. Some
operations will undoubtedly return errors but when a service encounters an
error, it will propagate the error upwards in the stack and notify the caller
or log the event if necessary. </p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="birds-eye-view">Bird&#x27;s Eye View<a href="#birds-eye-view" class="hash-link" aria-label="Direct link to Bird&#x27;s Eye View" title="Direct link to Bird&#x27;s Eye View">​</a></h2><p>A high-level schematic of SoftPack is illustrated below outlining each major
component in the system.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="softpack-clients">SoftPack Clients<a href="#softpack-clients" class="hash-link" aria-label="Direct link to SoftPack Clients" title="Direct link to SoftPack Clients">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="softpack-command-line-interface-cli">SoftPack Command Line Interface (CLI)<a href="#softpack-command-line-interface-cli" class="hash-link" aria-label="Direct link to SoftPack Command Line Interface (CLI)" title="Direct link to SoftPack Command Line Interface (CLI)">​</a></h3><p>SoftPack provides a Command Line Interface (CLI) for use in *nix shells either
interactively or in non-interactive scripting environments. The CLI offers
full coverage of the functionality offered by SoftPack including the ability
to create and manage your environments, and the ability to search and discover
environments created and shared by others.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="softpack-web">SoftPack Web<a href="#softpack-web" class="hash-link" aria-label="Direct link to SoftPack Web" title="Direct link to SoftPack Web">​</a></h3><p>SoftPack Web provides a graphical interface for managing environments created
with SoftPack. In contrast with the CLI, the web interface offers a more
user-friendly experience when searching for environments created and shared by
others; or searching for available packages from a large collection; or narrowing
down the search based on specific versions of a package. The web interface can
also be used to monitor the status of in-progress tasks such as environment
creation requests initiated from the CLI.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="softpack-core">SoftPack Core<a href="#softpack-core" class="hash-link" aria-label="Direct link to SoftPack Core" title="Direct link to SoftPack Core">​</a></h2><p>SoftPack Core implements a service that listens to requests from SoftPack
clients and uses GitLab API to create, update or delete environments in the
SoftPack Artifacts repository. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="softpack-graphql">SoftPack GraphQL<a href="#softpack-graphql" class="hash-link" aria-label="Direct link to SoftPack GraphQL" title="Direct link to SoftPack GraphQL">​</a></h3><p>SoftPack GraphQL implements the <a href="https://graphql.org" target="_blank" rel="noopener noreferrer">GraphQL</a> service in
SoftPack. GraphQL is used because of the flexibility it offers when performing
complex queries. Unlike REST APIs where multiple queries from multiple
endpoints often require complex logic to be embedded in client interfaces,
GraphQL provides a query language that can span multiple sources, allowing the
server to optimise query results and reduce the amount of roundtrip calls a
client needs to make to perform a complex query.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="softpack-auth">SoftPack Auth<a href="#softpack-auth" class="hash-link" aria-label="Direct link to SoftPack Auth" title="Direct link to SoftPack Auth">​</a></h3><p>SoftPack Auth is an internal component of SoftPack Core responsible for
implementing authentication and authorization support.</p><p>Authentication is only necessary when the client is connected using SoftPack
CLI. SoftPack Web leverages LDAP and Okta support in Nginx and does not need to
perform its own authentication. </p><p>Authorization is carried out over LDAP regardless of whether the client is
connected using SoftPack CLI or SoftPack Web to verify that the user is
authorized to carry out the tasks they&#x27;re attempting to perform.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="softpack-artifacts">SoftPack Artifacts<a href="#softpack-artifacts" class="hash-link" aria-label="Direct link to SoftPack Artifacts" title="Direct link to SoftPack Artifacts">​</a></h2><p>SoftPack Artifacts is a GitLab repository that stores the following for each
environment:</p><ul><li>An environment file that defines the packages that are part of the
environment and any dependencies.</li><li>A module file that allows the environment to be loaded using the <code>module</code>
command.</li><li>Docker or singularity images stored in the container registry of the
repository.</li><li>metadata (yet-to-be-defined) for controlling visibility (private vs public)
and permissions (users or groups authorized to update the environment other
than the owner)</li></ul><p>Only SoftPack Core and SoftPack Builder are allowed to push changes to the
repository. End-users can only see the contents of the repository using
SoftPack CLI or SoftPack Web. Direct access to the repository is neither
allowed, nor required.</p><p>SoftPack Artifacts repository is structured to allow for environments to be
created and stored under a user or group hierarchy. This is how ownership of
an environment is determined and prevents one user from modifying another user&#x27;s
environment without explicit permission. </p><p>In the illustration below, a simplified view of the repository is shown with
users alice, bob, and charlie; groups named after capital cities (athens,
baku and cairo); and environments named after elements from the periodic table.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">├── groups</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   ├── athens</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │   └── environments</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │       └── zinc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   ├── baku</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │   └── environments</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │       ├── lithium</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   │       └── scandium</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│   └── cairo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│       └── environments</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│           ├── osmium</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">│           └── radium</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">└── users</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ├── alice</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    │   └── environments</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    │       ├── helium</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    │       └── nitrogen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ├── bob</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    │   └── environments</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    │       ├── potassium</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    │       └── radon</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    └── charlie</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        └── tungsten</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="softpack-builder">SoftPack Builder<a href="#softpack-builder" class="hash-link" aria-label="Direct link to SoftPack Builder" title="Direct link to SoftPack Builder">​</a></h2><p>SoftPack Builder is a lightweight service that listens to WebHooks from
SoftPack Artifacts repository and proceeds to build a container image for the
environment along with a module file. The module file is pushed to the repository
in the environment&#x27;s subdirectory while the container image is pushed to the
container registry and optionally applies any tags requested by the user.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="softpack-deploy-agent">SoftPack Deploy Agent<a href="#softpack-deploy-agent" class="hash-link" aria-label="Direct link to SoftPack Deploy Agent" title="Direct link to SoftPack Deploy Agent">​</a></h2><p>SoftPack Deploy Agent is another lightweight service that listens to
WebHooks from SoftPack Artifacts repository and deploys a module file and
container image built by SoftPack Builder.</p><p>The location of where the agent deploys the container image and module file
depends on the configuration of the agent. (TBD)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-scenarios">Usage Scenarios<a href="#usage-scenarios" class="hash-link" aria-label="Direct link to Usage Scenarios" title="Direct link to Usage Scenarios">​</a></h2><p>Putting all the pieces together, we can now proceed to walk through a typical
scenario of a user creating a new environment.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-new-environment">Creating a new environment<a href="#creating-a-new-environment" class="hash-link" aria-label="Direct link to Creating a new environment" title="Direct link to Creating a new environment">​</a></h3><p>This section describes the sequence of events generated from an end-user&#x27;s
request to create a new environment.</p><p>The SoftPack CLI and SoftPack Web clients operate in a similar fashion and
communicate only to the SoftPack Core. The synchronous command line interface
is similar to the asynchronous web interface with one exception that the
command line does not return control to the user until the request has
propagated through the system and the operation has completed.</p><p>The following sequence diagram illustrates the interaction between the various
components of the system resulting from a request to create a new environment
from the user. Each step of this sequence is explained in the table that
follows the sequence diagram.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-sequence">Event Sequence<a href="#event-sequence" class="hash-link" aria-label="Direct link to Event Sequence" title="Direct link to Event Sequence">​</a></h3><table><thead><tr><th>#</th><th>Event</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td>Create Environment</td><td>End-user sends a request to create a new environment using either the Web Client or the Command Line Interface.</td></tr><tr><td>2</td><td>GraphQL Mutation</td><td>SoftPack client sends the request to create a new environment using GraphQL Mutation over HTTP</td></tr><tr><td>3</td><td>Create Environment in SoftPack Artifacts repository</td><td>SoftPack Core creates a new environment in SoftPack Artifacts repository</td></tr><tr><td>4</td><td>HTTP RESPONSE<br>Status = OK</td><td>SoftPack Artifacts repository returns <code>OK</code> to SoftPack Core</td></tr><tr><td>5</td><td>HTTP RESPONSE<br>Status = OK</td><td>SoftPack Core returns <code>OK</code> to the client</td></tr><tr><td>6</td><td>WebSocket (WS) <br> Status = In Progress</td><td>SoftPack Core sends <code>In Progress</code> status to the client in a WebSocket notification</td></tr><tr><td>7</td><td>Environment Created Webhook from SoftPack Artifacts repository</td><td>SoftPack Artifacts repository sends a Webhook notification to the Softpack Builder that a new environment has been created</td></tr><tr><td>8</td><td>HTTP RESPONSE<br>Status = OK</td><td>SoftPack Builder returns OK to SoftPack Artifacts repository</td></tr><tr><td>9</td><td>Push Module Definition from SoftPack Builder</td><td>SoftPack Builder pushes a new module definition file to SoftPack Artifacts repository</td></tr><tr><td>10</td><td>HTTP RESPONSE<br>Status = OK</td><td>SoftPack Artifacts repository returns OK to SoftPack Builder</td></tr><tr><td>11</td><td>Push Container Image from SoftPack Builder</td><td>SoftPack Builder pushes a new container image to SoftPack Artifacts repository</td></tr><tr><td>12</td><td>HTTP RESPONSE<br>Status = OK</td><td>SoftPack Artifacts repository returns OK to SoftPack Builder</td></tr><tr><td>13</td><td>Module &amp; UImage Created Webhook from SoftPack Artifacts repository</td><td>SoftPack Artifacts repository sends a Webhook notification to the SoftPack Deploy Agent that a new module definition and container image have been created</td></tr><tr><td>14</td><td>HTTP RESPONSE<br>Status = OK</td><td>SoftPack Deploy Agent returns OK to SoftPack Artifacts repository</td></tr><tr><td>15</td><td>WebSocket (WS) <br> Status = OK</td><td>SoftPack Deploy Agent sends <code>OK</code> to SoftPack Core once the module file and container images are deployed</td></tr><tr><td>16</td><td>WebSocket (WS) <br> Status = OK</td><td>SoftPack Core sends <code>OK</code> to SoftPack client that the new environment has been created</td></tr><tr><td>17</td><td>Environment Created</td><td>SoftPack client updates the status and notifies that user that their new environment has been created</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-05-16T21:02:09.000Z">May 16, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/softpack-docs/docs/overview/features"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Features</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/softpack-docs/docs/overview/testing_strategy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testing Strategy</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#birds-eye-view" class="table-of-contents__link toc-highlight">Bird&#39;s Eye View</a></li><li><a href="#softpack-clients" class="table-of-contents__link toc-highlight">SoftPack Clients</a><ul><li><a href="#softpack-command-line-interface-cli" class="table-of-contents__link toc-highlight">SoftPack Command Line Interface (CLI)</a></li><li><a href="#softpack-web" class="table-of-contents__link toc-highlight">SoftPack Web</a></li></ul></li><li><a href="#softpack-core" class="table-of-contents__link toc-highlight">SoftPack Core</a><ul><li><a href="#softpack-graphql" class="table-of-contents__link toc-highlight">SoftPack GraphQL</a></li><li><a href="#softpack-auth" class="table-of-contents__link toc-highlight">SoftPack Auth</a></li></ul></li><li><a href="#softpack-artifacts" class="table-of-contents__link toc-highlight">SoftPack Artifacts</a></li><li><a href="#softpack-builder" class="table-of-contents__link toc-highlight">SoftPack Builder</a></li><li><a href="#softpack-deploy-agent" class="table-of-contents__link toc-highlight">SoftPack Deploy Agent</a></li><li><a href="#usage-scenarios" class="table-of-contents__link toc-highlight">Usage Scenarios</a><ul><li><a href="#creating-a-new-environment" class="table-of-contents__link toc-highlight">Creating a new environment</a></li><li><a href="#event-sequence" class="table-of-contents__link toc-highlight">Event Sequence</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023  
                    Human Genetics Informatics @ 
                    <a href="https://www.sanger.ac.uk" target="_blank">Wellcome Sanger Institute</a></div></div></div></footer></div>
<script src="/softpack-docs/assets/js/runtime~main.9ae93b6b.js"></script>
<script src="/softpack-docs/assets/js/main.19df5f50.js"></script>
</body>
</html>